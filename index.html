<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>Virtual Field Trip</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.28.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.28.0/mapbox-gl.css' rel='stylesheet' />
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
</head>
<body>

<style>
.mapboxgl-popup {
        max-width: 400px;
        font: 12px/20px 'Open Sans', sans-serif;
    }
.marker {
        display: block;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        padding: 0;
}
#menu {
        position: absolute;
        background: #fff;
        color: #404040;
        padding: 10px;
        border: 1px solid rgba(0,0,0,0.4);
        font-family: 'Open Sans', sans-serif;
    }
#ball {
        background: #fff;
        position: absolute;
        z-index: 1;
        top: 10px;
        right: 10px;
        border-radius: 3px;
        width: 120px;
        border: 1px solid rgba(0,0,0,0.4);
        font-family: 'Open Sans', sans-serif;
    }

#ball a {
        font-size: 13px;
        color: #404040;
        display: block;
        margin: 0;
        padding: 0;
        padding: 10px;
        text-decoration: none;
        border-bottom: 1px solid rgba(0,0,0,0.25);
        text-align: center;
    }

#ball a:last-child {
        border: none;
    }

#ball a:hover {
        background-color: #f8f8f8;
        color: #404040;
    }

#ball a.active {
        background-color: #3887be;
        color: #ffffff;
    }

#ball a.active:hover {
        background: #3074a4;
    }
</style>
<nav id="ball"></nav>
<div id='map'></div>
<div id='menu'>
    <input id='outdoors' type='radio' name='rtoggle' value='outdoors' checked='checked'>
    <label for='outdoors'>default</label>
    <input id='dark' type='radio' name='rtoggle' value='dark'>
    <label for='dark'>highlight icons</label>
    <input id='satellite' type='radio' name='rtoggle' value='satellite'>
    <label for='satellite'>satellite imagery</label>
</div>

<script>
mapboxgl.accessToken = 'pk.eyJ1IjoiYW5kcmV3ODQ1NTUiLCJhIjoiY2lydnp2Nzk3MGoza2ZnbTh1b2FoenFqYSJ9.iPSB6vUKQLifDYV570B8zg';

//geojson as a var rather than a source so that markers can be used, which allows local icon images and are unaffected by changing background styles, which can be the default mapbox ones.
var geojson = {
    "type": "FeatureCollection",
    "features": [
        {
            "type": "Feature",
            "properties": {
                "description": "<a href=\"http://www.sciencedirect.com.ezproxy.auckland.ac.nz/science/article/pii/S0278434311001683\" target=\"_blank\"><strong>Wave transformation on a sub-horizontal shore platform, Tatapouri, North Island, New Zealand</strong><a/><p>Waves are generally considered to be an important control on shore platform evolution but there have been very few detailed studies of wave dynamics on rocky coasts. This study provides a detailed description of wave transformation processes across a shore platform near Gisborne, New Zealand.</p>",
                "title": "Wave transformation on a sub-horizontal shore platform, Tatapouri, North Island, New Zealand",
                "icon": 'url(images/pdf-flat.png)'
                //just reference local image per geojson feature, each is seperate = better control, and use on geojson for multiple types of the data, rather than splitting them up. Could also draw from a local .geojson file, but probably easier to keep it internal.
            },
            "geometry": {
                "type": "Point",
                "coordinates": [178.14901,-38.642099]
                //coordinates all in WGS84, common across webmapping
            }
        },
        {
            "type": "Feature",
            "properties": {
                "description": "<a href=\"http://www.sciencedirect.com.ezproxy.auckland.ac.nz/science/article/pii/S0025322709002928\" target=\"_blank\"><strong>Coastal progradation and sediment partitioning in the Holocene Waipaoa Sedimentary System, New Zealand</strong><p></a>Over the late Holocene highstand, the shoreline at Poverty Bay, NZ migrated 12 km seaward, fed by sediment from the Waipaoa river. Paleo-shorelines indicate steadily decelerating progradation, possibly signaling changes in forcing on the Waipaoa Sedimentary System.</p>",
                    "title": "Coastal progradation and sediment partitioning in the Holocene Waipaoa Sedimentary System, New Zealand",
                    "icon": 'url(images/pdf-flat.png)'
            },
            "geometry": {
                "type": "Point",
                "coordinates": [177.889078,-38.6263790]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "description": "<a href=\"http://www.sciencedirect.com.ezproxy.auckland.ac.nz/science/article/pii/S0025322709002667\" target=\"_blank\"><strong>Rapid channel response to variability in sediment supply: Cutting and filling of the Tarndale Fan, Waipaoa catchment, New Zealand</strong><a/><p>In the headwaters of the Waipaoa catchment, fluvio-mass movement gully complexes are currently significant contributors of sediment, delivery of which is buffered by fans which have developed in the small tributaries that lead from the gully complexes.</p>",
                "title": "Rapid channel response to variability in sediment supply: Cutting and filling of the Tarndale Fan, Waipaoa catchment, New Zealand",
                "icon": 'url(images/pdf-flat.png)'
            },
            "geometry": {
                "type": "Point",
                "coordinates": [177.7887,-38.2425]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "description": "<a href=\"http://www.sciencedirect.com.ezproxy.auckland.ac.nz/science/article/pii/S0278434310003705\" target=\"_blank\"><strong>Hydrodynamics and sediment-transport in the nearshore of Poverty Bay, New Zealand: Observations of nearshore sediment segregation and oceanic storms</strong><a/><p>Nearshore regions act as an interface between the terrestrial environment and deeper waters. As such, they play important roles in the dispersal of fluvial sediment and the transport of sand to and from the shoreline. This study focused on the nearshore of Poverty Bay, New Zealand, and the processes controlling the dispersal of sediment from the main source, the Waipaoa River.</p>",
                "title": "Hydrodynamics and sediment-transport in the nearshore of Poverty Bay, New Zealand: Observations of nearshore sediment segregation and oceanic storms",
                "icon": 'url(images/pdf-flat.png)'
            },
            "geometry": {
                "type": "Point",
                "coordinates": [177.96,-38.72]
            }
        },
        ]
};




//generate map as mapboxgl, set the starting style
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/outdoors-v9',
    center: [177.8664, - 38.4695],
    zoom: 9.5
    //bigger number means more zoomed in, from 1 to 20
});


var layerList = document.getElementById('menu');
var inputs = layerList.getElementsByTagName('input');


//switch styles, uses the default mapbox styles incl. digital globe imagery

function switchLayer(layer) {
    var layerId = layer.target.id;
    map.setStyle('mapbox://styles/mapbox/' + layerId + '-v9');
}

for (var i = 0; i < inputs.length; i++) {
    inputs[i].onclick = switchLayer;
}

// add markers to map
geojson.features.forEach(function(marker) {
    //add popups to each marker instance, otherwise you only get one popup
    var popup = new mapboxgl.Popup({offset:[0, -30]})
    .setHTML(marker.properties.description);
    // create a DOM element for the marker
    var el = document.createElement('div');
    el.className = 'marker';
    el.style.backgroundImage = marker.properties.icon;
    //the pdf icon comes from freeiconshop.com, need to attribute
    //set how big the marker icons appear, independent of scale
    el.style.width = 50 + 'px';
    el.style.height = 50 + 'px';
    //add markers to map, with an offset half that of the width and height to position correctly    
    new mapboxgl.Marker(el, {offset: [-25, -25]})
        .setLngLat(marker.geometry.coordinates)
        .setPopup(popup)
        .addTo(map);
});


//toggle mapbox layers on and off. works by layer id, dosen't seem to work with markers.

var toggleableLayerIds = ['Videos', 'Imagery', 'Progradational History'];

for (var i = 0; i < toggleableLayerIds.length; i++) {
    var id = toggleableLayerIds[i];

    var link = document.createElement('a');
    link.href = '#';
    link.className = 'active';
    link.textContent = id;

    link.onclick = function (e) {
        var clickedLayer = this.textContent;
        e.preventDefault();
        e.stopPropagation();

        var visibility = map.getLayoutProperty(clickedLayer, 'visibility');

        if (visibility === 'visible') {
            map.setLayoutProperty(clickedLayer, 'visibility', 'none');
            this.className = '';
        } else {
            this.className = 'active';
            map.setLayoutProperty(clickedLayer, 'visibility', 'visible');
        }
    };

    var layers = document.getElementById('ball');
    layers.appendChild(link);
}


//redraw on mousemove, a hacky way to ensure layers refresh when background style is changed, i.e. from basic to sattelite.

map.on('mousemove', function () {
   


    map.addSource('progPoly', {
        'type': 'geojson',
        'data': 
            {
                "type":"FeatureCollection","features":[
                {"type":"Feature",
            "properties":
            {
                "stroke":"#555555","stroke-width":2,"stroke-opacity":1,"fill":"#0000ff","fill-opacity":0.5,"OBJECTID":1,
            "Id":0,"Shape_Leng":46959.6575124,
            "Shape_Area":13567037.9257,
            "AGE":"1 ka"},
            "geometry":
            {"type":"MultiPolygon",
            "coordinates":[[[[178.02241618407996,-38.66915682893917],[178.03267477214803,-38.67157359199435],[178.04213284631362,-38.67383344189553],[178.04418265716322,-38.674459536704845],[178.04813567740135,-38.67565983196754],[178.04939989356868,-38.676044422477474],[178.05998879216673,-38.67940775884615],[178.06102662839092,-38.67973351482968],[178.0634330488487,-38.68282142768877],[178.06310299613523,-38.683312223533264],[178.06262153238063,-38.68338076707311],[178.06174961139615,-38.68308507748484],[178.0606724109963,-38.682464758629465],[178.05671371071065,-38.68063526020347],[178.05478148304354,-38.67995665231968],[178.04986685581966,-38.67835891907593],[178.04794143468743,-38.67777519341699],[178.03705555754797,-38.675101019749526],[178.02940138671119,-38.6734300650678],[178.01951874987765,-38.672045090190025],[178.01750242373026,-38.671893588118735],[178.0126147836942,-38.67153192184926],[178.00945044385134,-38.671477247308516],[178.00454427516422,-38.671903363523384],[178.00287971670562,-38.67208911074454],[178.00137008619262,-38.67239570316042],[177.99246315719992,-38.67454017643725],[177.98755967267886,-38.67623290660008],[177.98308898658013,-38.67802492998607],[177.97509106102677,-38.68171481578252],[177.97338613407607,-38.682549885097735],[177.97047093389241,-38.684341822250595],[177.96368531176444,-38.68906205051958],[177.9601619916594,-38.69173728796152],[177.95826347686653,-38.693295104340265],[177.95326387799994,-38.69836766526229],[177.95229893736615,-38.69936160908549],[177.94872564667676,-38.703086911994916],[177.94801295117816,-38.70421306690178],[177.94759026419254,-38.70513632211625],[177.93944837373343,-38.72440392305622],[177.93825794248863,-38.7280875563296],[177.93779485556976,-38.73019179922867],[177.93752437373598,-38.73508725342018],[177.9376063503956,-38.73627500178616],[177.9376637374709,-38.73710642596631],[177.93830524777147,-38.740891163182],[177.93913332917344,-38.7440723829628],[177.940063938892,-38.74653452024641],[177.94178796582236,-38.750571168261644],[177.94258134979646,-38.75214568385294],[177.94237651864032,-38.753583826621714],[177.94186009964136,-38.7549160538805],[177.94066927583276,-38.75639598015844],[177.93973664580304,-38.75720978757706],[177.93881094627582,-38.75768379671179],[177.93571145311847,-38.751573054349606],[177.93478337125904,-38.748705759371624],[177.9343177241417,-38.747248351884956],[177.9327210405893,-38.73997798341901],[177.93241783762141,-38.73822780081727],[177.93237367015385,-38.73670490537084],[177.93249838056977,-38.73498427063456],[177.93330725958418,-38.72465789930349],[177.9338877823618,-38.7207261343399],[177.9360811646551,-38.713724241006844],[177.9369334646371,-38.711972809567385],[177.941340249078,-38.704448284589596],[177.94667194522367,-38.69712263669693],[177.94893283411392,-38.69464430326013],[177.95139841222647,-38.69249078231692],[177.9567337258878,-38.68788052919867],[177.95880741485595,-38.6862199965671],[177.96783045738732,-38.68045182803395],[177.97035721346566,-38.678881583667106],[177.97508540972538,-38.67637844482695],[177.976379139143,-38.6757514874045],[177.98196812446417,-38.67308289378583],[177.98420491784353,-38.67203439085804],[177.98626645350424,-38.67108863410536],[177.989422003332,-38.67014370844362],[177.99263806008406,-38.66919610882489],[177.99776991252,-38.66783283512798],[177.99927154802705,-38.66757790814273],[178.00222412800798,-38.667213113333524],[178.00555018166992,-38.666975164971674],[178.0071928499816,-38.66699997245422],[178.01103680306608,-38.667216116364614],[178.012689432796,-38.66738336119196],[178.0160046770301,-38.66786029318022],[178.02241618407996,-38.66915682893917]]]]}},
            {
                "type":"Feature","properties":
                {
                    "stroke":"#555555","stroke-width":2,
                    "stroke-opacity":1,"fill":"#008080",
                    "fill-opacity":0.5,"OBJECTID":2,
                    "Id":1,
                    "Shape_Leng":49525.1799892,
                    "Shape_Area":17745319.0209,
                    "AGE":"2 ka"},
                    "geometry":
                    {
                        "type":"MultiPolygon",
                        "coordinates":[[[[178.02031854512796,-38.663588957365434],[178.04534445281172,-38.671621934008094],[178.04931186136577,-38.67293925653232],[178.05857665401481,-38.67611140621836],[178.06030174275384,-38.676870409089936],[178.06095354415433,-38.67856933525461],[178.06106702562917,-38.679100439739656],[178.06102662839092,-38.67973351482968],[178.05369161819473,-38.6774309312],[178.04939989356868,-38.676044422477474],[178.04213284631362,-38.67383344189553],[178.02241618407996,-38.66915682893917],[178.0160046770301,-38.66786029318022],[178.01407111087326,-38.667591936534976],[178.0121739175022,-38.66733119419552],[178.00956989283466,-38.66715447391421],[178.0071928499816,-38.66699997245422],[178.00555018166992,-38.666975164971674],[178.00222412800798,-38.667213113333524],[178.00011270530626,-38.66749443143967],[177.99841707052883,-38.66772297252924],[177.99609971713312,-38.66828555358514],[177.99263806008406,-38.66919610882489],[177.99029902405232,-38.669850359575925],[177.98626645350424,-38.67108863410536],[177.98420491784353,-38.67203439085804],[177.98226798480096,-38.67294233748957],[177.976379139143,-38.6757514874045],[177.97508540972538,-38.67637844482695],[177.97035721346566,-38.678881583667106],[177.96783045738732,-38.68045182803395],[177.96195230437624,-38.68422798093973],[177.9586354853954,-38.68638810419884],[177.9567337258878,-38.68788052919867],[177.95139841222647,-38.69249078231692],[177.9495537622147,-38.69412142174486],[177.94838180751862,-38.69534633066514],[177.94686587981545,-38.69693769838183],[177.94229229978583,-38.70326437838053],[177.93654762744276,-38.71276569386668],[177.93595502052796,-38.71417255019175],[177.9338877823618,-38.7207261343399],[177.93330725958418,-38.72465789930349],[177.93249838056977,-38.73498427063456],[177.93237367015385,-38.73670490537084],[177.93241783762141,-38.73822780081727],[177.932608096307,-38.73932604668125],[177.9343177241417,-38.747248351884956],[177.9345848265133,-38.74808435139202],[177.9355431699196,-38.751003191081004],[177.93881094627582,-38.75768379671179],[177.93790911318908,-38.75859158263742],[177.9363962720972,-38.7587152037715],[177.9351458109335,-38.75823209006115],[177.93387283798876,-38.75632045146802],[177.93222901085034,-38.75233984786333],[177.93149530016393,-38.75052448812515],[177.9306448444232,-38.748118449420424],[177.9294092467842,-38.74453746107596],[177.92870242896245,-38.74200620963993],[177.92817596769697,-38.739884258076415],[177.9275328107844,-38.7371716226564],[177.92737926354954,-38.73604644857381],[177.9265647844377,-38.72863570800379],[177.92675391933082,-38.72475623857304],[177.92692139853747,-38.72295446726565],[177.92759893038263,-38.71936002969973],[177.92814848284252,-38.716299188355954],[177.92843755441277,-38.714976626381244],[177.92948493793176,-38.71141825361562],[177.93004445091154,-38.709607769522385],[177.9312637333483,-38.70633992352673],[177.93356657266398,-38.70225194707702],[177.93493503023524,-38.700049859271175],[177.9358261212678,-38.69864225110732],[177.9367253645116,-38.697353414685914],[177.93869169402353,-38.69500686061423],[177.94129717845342,-38.692080445166766],[177.9422184870155,-38.69104558830493],[177.94363975025408,-38.689615463989426],[177.9465660787675,-38.68687073409655],[177.94979115280833,-38.684053699496594],[177.95602372623327,-38.67967939725134],[177.96228019214985,-38.67566112486373],[177.9758498571675,-38.66865063867537],[177.983138366073,-38.66530199281519],[177.98573157771946,-38.66435736414165],[177.99540835931734,-38.66150148956008],[178.00392937745394,-38.660600314692466],[178.00880962615184,-38.66086738768524],[178.01150600571543,-38.66140675821956],[178.01397936234002,-38.662015209324245],[178.02031854512796,-38.663588957365434]]]]}},
            {
                "type":"Feature",
                "properties":{
                    "stroke":"#555555",
                    "stroke-width":2,
                    "stroke-opacity":1,
                    "fill":"#00ff80",
                    "fill-opacity":0.5,
                    "OBJECTID":3,
                    "Id":2,
                    "Shape_Leng":52966.5753969,
                    "Shape_Area":23165187.0615,
                    "AGE":"3 ka"
                },
                "geometry":
                {
                    "type":"MultiPolygon",
                    "coordinates":[[[[178.02252353994285,-38.658844443698186],[178.0346604405914,-38.663800801283],[178.05322059645698,-38.671050744022914],[178.05434475539005,-38.67147851492847],[178.05821881640964,-38.67297824982155],[178.05919477128708,-38.673888868126085],[178.06030174275384,-38.676870409089936],[178.05857665401481,-38.67611140621836],[178.04931186136577,-38.67293925653232],[178.02031854512796,-38.663588957365434],[178.01397936234002,-38.662015209324245],[178.01250550813148,-38.661652645436526],[178.00880962615184,-38.66086738768524],[178.00392937745394,-38.660600314692466],[177.99540835931734,-38.66150148956008],[177.98573157771946,-38.66435736414165],[177.983138366073,-38.66530199281519],[177.9758498571675,-38.66865063867537],[177.96228019214985,-38.67566112486373],[177.96024528884243,-38.676998433795696],[177.9581386550595,-38.67839831850841],[177.9553238829314,-38.68029083581957],[177.94979115280833,-38.684053699496594],[177.9465660787675,-38.68687073409655],[177.94254425566345,-38.69071779534347],[177.93869169402353,-38.69500686061423],[177.9367253645116,-38.697353414685914],[177.9358261212678,-38.69864225110732],[177.93493503023524,-38.700049859271175],[177.93356657266398,-38.70225194707702],[177.9312637333483,-38.70633992352673],[177.93004445091154,-38.709607769522385],[177.92948493793176,-38.71141825361562],[177.92843755441277,-38.714976626381244],[177.92804659951625,-38.716956774384876],[177.92692139853747,-38.72295446726565],[177.9265647844377,-38.72863570800379],[177.92737926354954,-38.73604644857381],[177.92768266145197,-38.73762879918098],[177.92847301630692,-38.74088424382265],[177.92893697728653,-38.742777610717965],[177.9294092467842,-38.74453746107596],[177.9306448444232,-38.748118449420424],[177.9313480195765,-38.7500934619918],[177.93259383285687,-38.75321783080347],[177.93347519423665,-38.75496737359194],[177.9346128359838,-38.757122989447765],[177.9351458109335,-38.75823209006115],[177.93390000663624,-38.75825701967473],[177.93279797141196,-38.75816070197549],[177.9293623978455,-38.756876532711516],[177.92838673402218,-38.75596479844426],[177.92549815271707,-38.749368356538355],[177.92448516209703,-38.747028693044875],[177.9239016703874,-38.74562386422538],[177.9224906389599,-38.74191916563124],[177.92028361934234,-38.73548438921391],[177.9198118421214,-38.73393187388578],[177.91880398716984,-38.72635053240798],[177.9186919564742,-38.72445852585879],[177.91867903780206,-38.7222791240807],[177.9187493812787,-38.72131126250632],[177.91899082956243,-38.71951423843401],[177.9193652985768,-38.71770236983374],[177.9213739486201,-38.707992515820486],[177.9221234822319,-38.70562608375746],[177.92406969666803,-38.701207876194516],[177.92593364608533,-38.69736490358335],[177.92674176063346,-38.69585365550274],[177.92766455680572,-38.69424225980453],[177.9293133076102,-38.69169485380758],[177.93038012438373,-38.69041089623726],[177.93566612592585,-38.68418360529637],[177.93679333823252,-38.68289703825164],[177.93929991186138,-38.68045614655084],[177.94050398582044,-38.67940453663438],[177.94154257123955,-38.678598169314135],[177.94287762675356,-38.67768393492879],[177.94851068971076,-38.6738714840108],[177.94990616950403,-38.67295460990923],[177.95368787383092,-38.67050696773868],[177.9547360281044,-38.669843027634535],[177.96993100149092,-38.661954189211556],[177.9734104487758,-38.6604241256424],[177.97885952418645,-38.658381096797925],[177.98426748460477,-38.656625465382604],[177.9860586830605,-38.65616775106567],[177.98857028186498,-38.6555839162415],[177.99030744396146,-38.6552237440555],[177.99468055415562,-38.65432190912278],[178.0021124934693,-38.6537176530974],[178.00478477123374,-38.653698357912205],[178.00766199963033,-38.65400374065551],[178.01340239958586,-38.65528196293986],[178.0152630710507,-38.655821420258256],[178.017200963494,-38.65659576446468],[178.02252353994285,-38.658844443698186]]]]}},{

                "type":"Feature",
                        "properties":{
                            "stroke":"#555555",
                            "stroke-width":2,
                            "stroke-opacity":1,"fill":"#00ff00",
                            "fill-opacity":0.5,
                            "OBJECTID":4,
                            "Id":3,
                            "Shape_Leng":54458.9908075,
                            "Shape_Area":25708190.3997,
                            "AGE":"4 ka"},
                            "geometry":
                            {
                                "type":"MultiPolygon",
                        "coordinates":[[[[177.92448516209703,-38.747028693044875],[177.92838673402218,-38.75596479844426],[177.92360963796997,-38.75285421348537],[177.92217357588544,-38.75055621787484],[177.92070818829845,-38.74783059910488],[177.9199807415645,-38.74521677233947],[177.91951164850965,-38.742377620081584],[177.91939187972605,-38.739309308285],[177.91940556106783,-38.72986024249235],[177.9196531753877,-38.73250909470048],[177.9224906389599,-38.74191916563124],[177.92337887155327,-38.744216468566606],[177.92448516209703,-38.747028693044875]]],[[[178.0217580109291,-38.65212476832873],[178.03184036391156,-38.65747956960384],[178.0373663027711,-38.66088614421772],[178.04048974411563,-38.663824496361514],[178.0421503140543,-38.66475333467488],[178.0434248383895,-38.665377218476536],[178.04710469083122,-38.66714779315],[178.0503483977277,-38.667900803436375],[178.05422059384475,-38.66916252355559],[178.0562475156209,-38.67011101519899],[178.0574009928699,-38.670954397923495],[178.0584837161122,-38.67208671778031],[178.05919477128708,-38.673888868126085],[178.05821881640964,-38.67297824982155],[178.05434475539005,-38.67147851492847],[178.05322059645698,-38.671050744022914],[178.05072325301768,-38.670110654624615],[178.04525866010889,-38.66807591190614],[178.0331123855404,-38.66339112090868],[178.02689044367676,-38.66087624121997],[178.02440765294503,-38.65971627368053],[178.02252353994285,-38.658844443698186],[178.017200963494,-38.65659576446468],[178.01340239958586,-38.65528196293986],[178.00766199963033,-38.65400374065551],[178.00478477123374,-38.653698357912205],[178.0021124934693,-38.6537176530974],[177.99468055415562,-38.65432190912278],[177.98857028186498,-38.6555839162415],[177.9860586830605,-38.65616775106567],[177.9810011464513,-38.65771791323168],[177.97885952418645,-38.658381096797925],[177.9771419884823,-38.659026153188734],[177.97283245475572,-38.66069066259034],[177.96993100149092,-38.661954189211556],[177.9547360281044,-38.669843027634535],[177.94851068971076,-38.6738714840108],[177.94154257123955,-38.678598169314135],[177.93929991186138,-38.68045614655084],[177.93679333823252,-38.68289703825164],[177.9316189532628,-38.68897671149111],[177.9293133076102,-38.69169485380758],[177.92766455680572,-38.69424225980453],[177.92593364608533,-38.69736490358335],[177.92406969666803,-38.701207876194516],[177.9213739486201,-38.707992515820486],[177.92045643633836,-38.713224976726174],[177.9187493812787,-38.72131126250632],[177.9186863968009,-38.72352077513224],[177.9166793951661,-38.7194252082345],[177.91184207965054,-38.70676373147539],[177.91113996361102,-38.704506130170195],[177.91369303673392,-38.69717975189038],[177.91448756606,-38.695466646386116],[177.91649207756475,-38.69145112217538],[177.9218818524885,-38.68228963353855],[177.9228725747709,-38.680782621580384],[177.92378947350332,-38.67952887616023],[177.925050422498,-38.67797470586335],[177.9283892834409,-38.674152821513744],[177.9320431557063,-38.67099431555883],[177.93867742518358,-38.66599865644135],[177.94534737125247,-38.66092743744951],[177.9471823679681,-38.65977755209881],[177.94915855289707,-38.65869312336521],[177.9512255637894,-38.65760480896867],[177.9533809338714,-38.656476971234696],[177.95615764707583,-38.6551082866624],[177.96000018441546,-38.6533368730035],[177.96435713840924,-38.65175787103672],[177.96614509125183,-38.651252953669854],[177.9737080211036,-38.64925123021239],[177.9760961509639,-38.64881356658146],[177.9808241576791,-38.64794692435205],[177.98511756934127,-38.64715976237886],[177.98864160450535,-38.646433843572076],[177.99185003635725,-38.646046482595445],[177.99389452648543,-38.645959003060135],[177.99621656549368,-38.64593107721681],[178.00351557211152,-38.646047162423876],[178.00465883461746,-38.64610534233087],[178.01118666271674,-38.64757624291358],[178.01309171814316,-38.64810192233721],[178.01440367617457,-38.648617323324515],[178.0217580109291,-38.65212476832873]]]]}},{"type":"Feature","properties":{"stroke":"#555555",
                    "stroke-width":2,
                    "stroke-opacity":1,
                    "fill":"#ffff00","fill-opacity":0.5,
                    "OBJECTID":5,
                    "Id":4,
                    "Shape_Leng":40422.2594981,"Shape_Area":28475086.7324,
                    "AGE":"5 ka"},
                    "geometry":{
                        "type":"MultiPolygon",
                    "coordinates":[[[[178.01187827116243,-38.64490065453605],[178.02021968642927,-38.64949744057675],[178.02260144453928,-38.650538485799096],[178.02685389302454,-38.652261262555946],[178.03120647581616,-38.6554089847701],[178.032874915895,-38.65667115642318],[178.0344369460369,-38.65876124410929],[178.0284993964192,-38.65597976874209],[178.0258046526878,-38.65459497692392],[178.02313548848414,-38.65292313260052],[178.0217580109291,-38.65212476832873],[178.01440367617457,-38.648617323324515],[178.00465883461746,-38.64610534233087],[177.99389452648543,-38.645959003060135],[177.99185003635725,-38.646046482595445],[177.98666727639417,-38.6468755937369],[177.97370802110362,-38.64925123021239],[177.9687385598165,-38.65053503122067],[177.96435713840924,-38.65175787103672],[177.96000018441546,-38.6533368730035],[177.95615764707583,-38.6551082866624],[177.9533809338714,-38.656476971234696],[177.94915855289707,-38.65869312336521],[177.9453473712525,-38.66092743744951],[177.9320431557063,-38.67099431555883],[177.9283892834409,-38.674152821513765],[177.925050422498,-38.67797470586335],[177.92378947350332,-38.67952887616025],[177.92188185248853,-38.68228963353855],[177.9200870338222,-38.68536723778707],[177.9171941046711,-38.69038516266553],[177.91538033245064,-38.6938566076801],[177.91369303673392,-38.69717975189038],[177.91274783029027,-38.70068604546946],[177.91113996361102,-38.704506130170195],[177.90956172965798,-38.70347520219883],[177.9077077227943,-38.70126605245288],[177.90585383540645,-38.69905686558144],[177.90183889609247,-38.69369831196807],[177.9022328837013,-38.69234757225069],[177.90559011339522,-38.68277186672115],[177.9070987189305,-38.67994475923855],[177.91167803115755,-38.6725332354358],[177.9126655228813,-38.67093479591162],[177.92044983911094,-38.66013216997153],[177.92488275554348,-38.65565673191006],[177.9285647998744,-38.65264232595551],[177.93192220294316,-38.65021332005382],[177.93447693076283,-38.64848525175063],[177.9364583807176,-38.64725787305477],[177.94302120179046,-38.64373994147129],[177.9470227544101,-38.641855018565025],[177.95486160000476,-38.63923531627715],[177.96083373116758,-38.63774273404139],[177.9635872552614,-38.63714916634364],[177.96599701385875,-38.63685605394633],[177.97239130649277,-38.636202593541874],[177.98157165660677,-38.635429888646534],[177.98363761557192,-38.63543697753299],[177.9888729683017,-38.63559447167848],[177.99911462582165,-38.636109153794195],[178.00138113906388,-38.637250886271666],[178.00521402400577,-38.639945428844584],[178.00996153763728,-38.64355352903047],[178.01187827116243,-38.64490065453605]]]]}},
                    {
                        "type":"Feature",
                        "properties":
                        {
                            "stroke":"#555555",
                            "stroke-width":2,
                            "stroke-opacity":1,
                            "fill":"#ff8000",
                            "fill-opacity":0.5,
                            "OBJECTID":6,
                            "Id":5,
                            "Shape_Leng":35679.8686359,
                            "Shape_Area":37007453.6625,
                            "AGE":"6 ka"},
                            "geometry":{
                                "type":"MultiPolygon",
                    "coordinates":[[[[177.99671657406898,-38.63240608121124],[177.99911462582165,-38.636109153794195],[177.9924256058244,-38.63601432095939],[177.9888729683017,-38.63559447167846],[177.98526510594863,-38.63548596276885],[177.98157165660677,-38.635429888646534],[177.97239130649277,-38.636202593541874],[177.96358725526136,-38.63714916634364],[177.95486160000476,-38.63923531627715],[177.9470227544101,-38.641855018565025],[177.94302120179046,-38.64373994147129],[177.9364583807176,-38.64725787305474],[177.9344769307628,-38.64848525175063],[177.93192220294316,-38.6502133200538],[177.9285647998744,-38.65264232595551],[177.9257995168336,-38.65497019610549],[177.92044983911094,-38.66013216997153],[177.91344608177747,-38.669671264489956],[177.90709871893054,-38.67994475923853],[177.90559011339522,-38.68277186672115],[177.90494306947247,-38.68575333527039],[177.90183889609244,-38.69369831196807],[177.8999116783297,-38.69221767857828],[177.8987463666751,-38.69118021032936],[177.8941102549186,-38.68525659119926],[177.8903450724064,-38.68032549739283],[177.88954379224094,-38.679272668759396],[177.89099824912753,-38.676266958217205],[177.89239648225717,-38.67270608789178],[177.89290643608106,-38.67082636865744],[177.8935315925519,-38.669299188578705],[177.89897343832104,-38.658206735705654],[177.9005251782614,-38.6555685041667],[177.90323235557463,-38.65116632797822],[177.90497531270296,-38.64866295752242],[177.9111268329365,-38.64132830166042],[177.9123112481639,-38.63999191970141],[177.91425976767695,-38.63783713901235],[177.9157166643879,-38.63648925115618],[177.9173503522417,-38.635062423225904],[177.92245228359224,-38.63105923330991],[177.92393332432306,-38.63006759921328],[177.92768850409456,-38.62769342643624],[177.92978578731362,-38.62638980669137],[177.9324280820089,-38.625063119581434],[177.94177581790476,-38.62188024284867],[177.94347240220154,-38.62137955727802],[177.94606755600557,-38.62069782650234],[177.95127734807224,-38.61961926046795],[177.96179482880856,-38.61888673456809],[177.96524659630472,-38.618739945312],[177.9693539012945,-38.61885103662497],[177.97309786290475,-38.618977463911165],[177.97749741770428,-38.61936170374672],[177.98145765321067,-38.61997894427322],[177.9839497450989,-38.62044433298365],[177.9881263847573,-38.62155240828303],[177.98946738711848,-38.622495700430356],[177.9908430869075,-38.62393779777088],[177.9923344510776,-38.62573229187549],[177.99335185871385,-38.62726115469555],[177.99671657406898,-38.63240608121124]]]]}},
                    {
                        "type":"Feature","properties":{"stroke":"#555555","stroke-width":2,"stroke-opacity":1,
                    "fill":"#ff0000",
                    "fill-opacity":0.5,
                    "OBJECTID":7,
                    "Id":6,
                    "Shape_Leng":42339.2269936,
                    "Shape_Area":61109849.8093,
                    "AGE":"7 ka"},
                    "geometry":{
                        "type":"MultiPolygon",
                    "coordinates":[[[[177.98701297865813,-38.61756696082804],[177.98778570677064,-38.61924927843281],[177.98838938542127,-38.62059574744005],[177.98812638475732,-38.62155240828303],[177.9839497450989,-38.62044433298365],[177.9802469128539,-38.61979025451697],[177.97749741770428,-38.61936170374672],[177.97477429259976,-38.61912389677728],[177.97105743855155,-38.61890857702369],[177.9680481146891,-38.61881573403165],[177.96524659630472,-38.618739945312],[177.96179482880856,-38.61888673456809],[177.95127734807227,-38.61961926046795],[177.94734674529207,-38.62043302473823],[177.94177581790476,-38.62188024284867],[177.93554409338776,-38.62400223803967],[177.92978578731362,-38.62638980669137],[177.92768850409456,-38.62769342643626],[177.92393332432306,-38.63006759921325],[177.9224522835922,-38.63105923330991],[177.9173503522417,-38.635062423225904],[177.9157166643879,-38.63648925115618],[177.91425976767695,-38.637837139012376],[177.91231124816392,-38.63999191970141],[177.91112683293656,-38.64132830166042],[177.90598793950537,-38.64747680333991],[177.90346164246606,-38.650837018784074],[177.89897343832104,-38.658206735705654],[177.89502088899474,-38.66626378876682],[177.8929064360811,-38.67082636865744],[177.89177127817567,-38.674233265121],[177.89099824912756,-38.676266958217205],[177.88954379224094,-38.679272668759396],[177.8873926640037,-38.677396121040914],[177.88517260354314,-38.67505095622802],[177.88379914055918,-38.67202074996448],[177.8839619143903,-38.670127005826494],[177.88421965990997,-38.66748595058599],[177.88442125533444,-38.666162377775635],[177.8848671431089,-38.66414242223324],[177.88732543588452,-38.65740664099067],[177.8883723468896,-38.65564739944384],[177.89230367011865,-38.649135709575894],[177.89322826920966,-38.64772463449442],[177.89474884479614,-38.645430863200424],[177.89615504059253,-38.64359930879078],[177.89773137191366,-38.639988034133076],[177.89847535573364,-38.63806988453031],[177.89876369427859,-38.635884960466],[177.89897811225543,-38.63261672653533],[177.8989107718469,-38.630561089863114],[177.89881621787495,-38.62810633774811],[177.89807919779506,-38.62585008651352],[177.89667022440793,-38.621220477716754],[177.89477379729988,-38.61478153905472],[177.89504168659565,-38.61122516609761],[177.89650991285893,-38.607103833870745],[177.8983673306258,-38.602280001389424],[177.9005450525887,-38.59681372287142],[177.9019335237262,-38.59366773443711],[177.90544170632043,-38.5884885841549],[177.90684276465157,-38.58659996468581],[177.90996246451297,-38.58320958206771],[177.91452289141023,-38.579586950259895],[177.91635294559524,-38.57865221686703],[177.91898580259013,-38.577740816307546],[177.921783350421,-38.57710831208541],[177.9250970603326,-38.5765683288438],[177.92874419074172,-38.57664314843061],[177.9347467451483,-38.57707575939494],[177.9365781360265,-38.577227058092745],[177.93955377755734,-38.578130430652834],[177.95095836260302,-38.582965007222455],[177.96186196529968,-38.588963286653986],[177.96378024572374,-38.59036838006173],[177.9696672884629,-38.59543550384703],[177.9715329608489,-38.59712859140487],[177.97624291861334,-38.60201676579375],[177.9785511594989,-38.60483442648057],[177.98207984524112,-38.60948682638674],[177.9834731627895,-38.61171446760228],[177.98478995555382,-38.61388817938477],[177.98701297865813,-38.61756696082804]]]]}}]}                   
    });


//add the polygon to the map and colour each according to object id
    map.addLayer({
        'id': 'Progradational History',
        'type': 'fill',
        'source': 'progPoly',
        'layout': {},
        'paint': {
            "fill-color": {
                property: 'OBJECTID',
                stops: [
                    [1, '#F2F12D'],
                    [2, '#EED322'],
                    [3, '#E6B71E'],
                    [4, '#DA9C20'],
                    [5, '#CA8323'],
                    [6, '#B86B25'],
                    [7, '#A25626']
                ]
            },
            'fill-opacity': 0.5,
            'fill-outline-color': 'white',
        }
        }
);

 map.addSource("points", {
        "type": "geojson",
        "data": {
            "type": "FeatureCollection",
            "features": [{
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [177.979429, -38.687555]
                },
                "properties": {
                    "age": "0 ka",
                    
                }
            },{
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [177.973502, -38.678670]
                },
                "properties": {
                    "age": "1 ka",
                    
                }
            },{
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [177.970297, -38.673131]
                },
                "properties": {
                    "age": "2 ka",
                    
                }
            },{
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [177.965087, -38.666965]
                },
                "properties": {
                    "age": "3 ka",
                    
                }
            },{
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [177.956933, -38.656721]
                },
                "properties": {
                    "age": "4 ka",
                    
                }
            },{
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [177.949314, -38.644069]
                },
                "properties": {
                    "age": "5 ka",
                    
                }
            },{
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [177.938508, -38.624282]
                },
                "properties": {
                    "age": "6 ka",
                    
                }
            },{
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [177.922029, -38.579056]
                },
                "properties": {
                    "age": "7 ka",
                    
                }
            }]
        }
    });

    map.addLayer({
        "id": "points",
        "type": "symbol",
        "source": "points",
        "layout": {

            "text-field": "{age}",
            "text-font": ["Open Sans Semibold", "Arial Unicode MS Bold"],

            "text-anchor": "top"
        }
    });
});




</script>
</body>
</html>